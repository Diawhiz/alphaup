{% extends 'news/base.html' %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <article class="max-w-4xl mx-auto">
        {% if article.image %}
        <img src="{{ article.image }}" alt="{{ article.title }}" class="w-full h-64 object-cover rounded-lg mb-6">
        {% endif %}
        
        <header class="mb-8">
            <h1 class="text-4xl font-bold mb-4">{{ article.title }}</h1>
            
            <div class="flex flex-wrap items-center text-gray-600 mb-4">
                {% if article.author %}
                <span class="mr-4">By {{ article.author }}</span>
                {% endif %}
                <span class="mr-4">{{ article.source }}</span>
                <time datetime="{{ article.published_at|date:'Y-m-d' }}" class="mr-4">
                    {{ article.published_at|date:"F j, Y" }}
                </time>
                <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded">
                    {{ article.category }}
                </span>
            </div>
        </header>

        {% if article.summary %}
        <div class="bg-gray-50 p-6 rounded-lg mb-8">
            <h2 class="text-xl font-semibold mb-3">Summary</h2>
            <p class="text-gray-700">{{ article.summary }}</p>
        </div>
        {% endif %}

        <div class="prose max-w-none">
            {{ article.full_content|linebreaks }}
        </div>

        <footer class="mt-8 pt-4 border-t border-gray-200">
            <p class="text-gray-600">
                Originally published on 
                <a href="{{ article.url }}" target="_blank" rel="noopener noreferrer" 
                   class="text-blue-600 hover:underline">
                    {{ article.source }}
                </a>
            </p>
            
            {% if article.keywords %}
            <div class="mt-4">
                <h3 class="text-lg font-semibold mb-2">Related Topics</h3>
                <div class="flex flex-wrap gap-2">
                    {% for keyword in article.keywords.split,'' %}
                    <span class="bg-gray-100 px-2 py-1 rounded text-sm">
                        {{ keyword }}
                    </span>
                    {% endfor %}
                </div>
            </div>
            {% endif %}
        </footer>
    </article>

    <!-- Comments section can go here -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        <div class="bg-white rounded-lg shadow-md overflow-hidden">
            <!-- Comments Section -->
            <div class="border-t p-6">
                <h3 class="font-semibold mb-4">Comments</h3>
                <div class="space-y-4">
                    {% for comment in article.comment_set.all %}
                    <div class="bg-gray-50 p-3 rounded">
                        <div class="font-medium">{{ comment.username }}</div>
                        <p class="text-gray-700">{{ comment.content }}</p>
                    </div>
                    {% endfor %}
                </div>

                    <!-- Comment Form -->
                    <form class="mt-4" onsubmit="return addComment(event, {{ article.id }})">
                        <input type="text" name="username" placeholder="Your name" 
                           class="w-full p-2 border rounded mb-2">
                        <textarea name="content" placeholder="Add a comment..." 
                              class="w-full p-2 border rounded mb-2"></textarea>
                        <button type="submit" 
                            class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">
                        Add Comment
                        </button>
                    </form>
                </div>
            </div>
            
            {% empty %}
            <div class="col-span-full text-center py-10">
                <p class="text-gray-600">No articles found.</p>
            </div>
            {% endfor %}
        </div>
    </div>
{% endblock %}